# @title 3. Thực nghiệm các phương pháp Truyền thống
from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, precision_recall_fscore_support

# Bảng lưu kết quả tổng hợp
results_table = []

def train_eval_traditional(name, vectorizer, clf):
    print(f"--- Đang chạy: {name} ---")
    # 1. Vector hóa
    X_train_vec = vectorizer.fit_transform(X_train)
    X_test_vec = vectorizer.transform(X_test)

    # 2. Huấn luyện
    clf.fit(X_train_vec, y_train)

    # 3. Dự đoán
    y_pred = clf.predict(X_test_vec)

    # 4. Đánh giá
    acc = accuracy_score(y_test, y_pred)
    p, r, f1, _ = precision_recall_fscore_support(y_test, y_pred, average='weighted')

    print(f"✅ {name}: Accuracy = {acc:.4f}")
    results_table.append({'Model': name, 'Accuracy': acc, 'Precision': p, 'Recall': r, 'F1-Score': f1})

# Cấu hình Logistic Regression chung
lr_model = LogisticRegression(solver='lbfgs', max_iter=1000)

# 3.1 One-Hot Encoding
train_eval_traditional("One-Hot + LR",
                       CountVectorizer(binary=True, max_features=10000),
                       lr_model)

# 3.2 Bag of Words (BoW)
train_eval_traditional("BoW + LR",
                       CountVectorizer(binary=False, max_features=10000),
                       lr_model)

# 3.3 TF-IDF
train_eval_traditional("TF-IDF + LR",
                       TfidfVectorizer(max_features=10000),
                       lr_model)
